import Head from 'next/head';

import MainDoor from '@/components/MainDoor';
import PostList from '@/components/PostList';
import { getPostsAndTags } from '@/lib';
import { useAppSelector } from '@/hooks/redux';
import { InitialPage } from '../types';

const Home = ({ tags, posts }: InitialPage) => {
  const isMainDoor = useAppSelector((state) => state.isMainDoor);

  return (
    <div>
      <Head>
        <title>웰컴키트 받고 싶은, 홍원배</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      {isMainDoor && <MainDoor />}
      <PostList tags={tags} posts={posts} />
    </div>
  );
};

export async function getStaticProps() {
  const notionDatabaseID = process.env.NOTION_POSTS_DATABASE;
  const { tags, posts } = await getPostsAndTags(notionDatabaseID!);

  return {
    props: {
      tags,
      posts,
    },
    revalidate: 60,
  };
}

export default Home;
